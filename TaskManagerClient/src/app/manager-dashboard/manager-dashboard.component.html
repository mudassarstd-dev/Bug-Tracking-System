<nav class="navbar">
  <h1 class="logo">Manager Dashboard</h1>
  <div class="nav-buttons">
    <button class="btn btn-primary" (click)="toggleTaskForm()">Create Task</button>
    <button class="btn btn-tertiary" (click)="logout()">Logout</button>
  </div>
</nav>

<div class="dashboard-container">
  <!-- Left Section: Tasks -->
  <section class="tasks-section">
    <h2>📋 Tasks Created</h2>

    <div *ngIf="tasks && tasks.length > 0; else noTasks">
      <table class="task-table">
        <thead>
          <tr>
            <th>Title</th>
            <th>Assigned To</th>
            <th>Status</th>
            <th>Deadline</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let task of tasks">
            <td>{{ task.title }}</td>
            <td>{{ task.assignedTo }}</td>
            <td>
              <span class="status" [ngClass]="task.status.toLowerCase()">{{ task.status }}</span>
            </td>
            <td>{{ task.deadline | date }}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <ng-template #noTasks>
      <p class="empty-state">No tasks created yet.</p>
    </ng-template>
  </section>

  <!-- Right Section: Employees -->
  <section class="employees-section">
    <h2>👥 Employees Under You</h2>

    <div *ngIf="employees && employees.length > 0; else noEmployees">
      <div class="employee-card" *ngFor="let emp of employees">
        <h3>{{ emp.name }}</h3>
        <p><strong>ID:</strong> {{ emp.id }}</p>
        <p><strong>Today’s Tasks:</strong> {{ emp.tasksToday }}</p>
      </div>
    </div>
    <ng-template #noEmployees>
      <p class="empty-state">No employees loaded yet.</p>
    </ng-template>
  </section>
</div>

<!-- Task Creation Form -->
<div *ngIf="showTaskForm" class="task-form-overlay">
  <div class="task-form-container">
    <h2>📝 Create New Task</h2>
    <form [formGroup]="taskForm" (ngSubmit)="onSubmitTask()">
      <div class="form-group">
        <label for="title">Title<span class="required">*</span></label>
        <input id="title" type="text" formControlName="title" placeholder="Enter task title" />
        <small class="error" *ngIf="taskForm.get('title')?.touched && taskForm.get('title')?.invalid">
          Title is required.
        </small>
      </div>

      <div class="form-group">
        <label for="description">Description</label>
        <textarea id="description" rows="3" formControlName="description" placeholder="Enter task description (optional)"></textarea>
      </div>

      <div class="form-group">
        <label for="deadline">Deadline<span class="required">*</span></label>
        <input id="deadline" type="date" formControlName="deadline" />
        <small class="error" *ngIf="taskForm.get('deadline')?.touched && taskForm.get('deadline')?.invalid">
          Deadline is required.
        </small>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary">Save Task</button>
        <button type="button" class="btn btn-cancel" (click)="toggleTaskForm()">Cancel</button>
      </div>
    </form>
  </div>
</div>